<html xmlns: xmlns: xmlns:>
<style>
    .myCanvas{
       background-image: url("{% url 'video_feed' %}");
    }
</style>
<h1 style="color: black">
    Video Stream
</h1>
<div style="width: 100%; overflow:hidden;">
    <div style="width: 250px; float: left;">
        <h2>Circle 1 Coordinates</h2>
        <p id="x1"></p>
        <p id="y1"></p></div>
    <div style="margin-left: 320px;overflow:hidden;">
        <h2>Circle 2 Coordinates</h2>
        <p id="x2"></p>
        <p id="y2"></p></div>
</div>


<canvas class="myCanvas" width="600" height="480"  id="imgCanvas1" onclick="draw(event)">
</canvas>
<canvas class="myCanvas" width="600" height="480"  id="imgCanvas2" onclick="draw2(event)">
</canvas><br><br>
<button style="height:50px;width:100px" type="submit" onclick="location.href='{% url 'grey_scale_page' %}'">Gray Scale</button>
<button style="height:50px;width:100px" type="submit" onclick="location.href='{% url 'binary_scale_page' %}'">Binary</button>
<button style="height:50px;width:100px" onclick="javascript:window.close();">Exit</button>
<div style="width: 100%; overflow: hidden;">
<div id="mydata" style="width: 320px; float: left;">
    <b>Current coordinates in the system of circle 1</b>
    <table id="myTableData"  border="1" cellpadding="2">
        <tr>
            <td>&nbsp;</td>
            <td><b>X1</b></td>
            <td><b>Y1</b></td>
        </tr>
</table>
</div>
<div style="margin-left: 180px;float: left;" >
    <b>Current coordinates in the system of circle 2</b>
    <table id="myTableData2"  border="1" cellpadding="3">
        <tr>
            <td><b>X2</b></td>
            <td><b>Y2</b></td>
        </tr>
</table>
</div>
<div style="margin-left: 920px;" >
    <b>Distance</b>
    <table id="myTableData3"  border="1" cellpadding="3">
        <tr>
            <td><b>Result</b></td>
        </tr>
</table>
</div>
</div>
&nbsp;

<script type="text/javascript">
    var canvas = document.getElementById("imgCanvas1");
    var canvas2 = document.getElementById("imgCanvas2");
    var context = canvas.getContext("2d");
    var context2 = canvas2.getContext("2d");
    var counter = 0;
    var counter2 = 0;

    //section to get the coordinates of the circle
    function getMousePosition(canvas, event) {



        if(counter == 1){
        let rect = canvas.getBoundingClientRect();
        let x1 = event.clientX - rect.left;
        let y1 = event.clientY - rect.top;

        console.log("Coordinate x1: " + x1, "Coordinate y1: " + y1);
        document.getElementById("x1").innerHTML = "x1 = " + x1;
        document.getElementById("y1").innerHTML = "y1 = " + y1;
        X1=x1;
        Y1=y1;
        addRow(x1,y1)
        }
        else if(counter == 2){
        let rect = canvas.getBoundingClientRect();
        let x2 = event.clientX - rect.left;
        let y2 = event.clientY - rect.top;

        console.log("Coordinate x2: " + x2, "Coordinate y2: " + y2);
        document.getElementById("x2").innerHTML = "x2 = " + x2;
        document.getElementById("y2").innerHTML = "y2 = " + y2;
        addRow2(x2,y2)
        //console.log(X1,Y1,x2,y2)
        let result = getDistance(X1,Y1,x2,y2)
        addRow3(result);
        DrawDottedLine(X1,x2,Y1,y2,result);

        }else if(counter == 3){
            context.clearRect(0,0,600,480);
               //clears the previous circle
            x1=x2=y1=y2=0;
            document.getElementById("x1").innerHTML = "x1 = " + x1;
            document.getElementById("y1").innerHTML = "y1 = " + y1;
            document.getElementById("x2").innerHTML = "x2 = " + x2;
            document.getElementById("y2").innerHTML = "y2 = " + y2
            return false;
        }


    }

        function getMousePosition2(canvas2, event) {
        if(counter2 == 1){
        let rect = canvas2.getBoundingClientRect();
        let x1 = event.clientX - rect.left;
        let y1 = event.clientY - rect.top;
        console.log("Coordinate x1: " + x1, "Coordinate y1: " + y1);
        document.getElementById("x1").innerHTML = "x1 = " + x1;
        document.getElementById("y1").innerHTML = "y1 = " + y1;
        }
        else if(counter2 == 2){
        let rect = canvas2.getBoundingClientRect();
        let x2 = event.clientX - rect.left;
        let y2 = event.clientY - rect.top;
        console.log("Coordinate x2: " + x2, "Coordinate y2: " + y2);
        document.getElementById("x2").innerHTML = "x2 = " + x2;
        document.getElementById("y2").innerHTML = "y2 = " + y2;
        }else if(counter2 == 3){
            context2.clearRect(0,0,600,480);
               //clears the previous circle
            x1=x2=y1=y2=0;
            document.getElementById("x1").innerHTML = "x1 = " + x1;
            document.getElementById("y1").innerHTML = "y1 = " + y1;
            document.getElementById("x2").innerHTML = "x2 = " + x2;
            document.getElementById("y2").innerHTML = "y2 = " + y2
            return false;
        }
    }

    let canvasElem = document.querySelector("canvas");
    let canvasElem2 = document.querySelector("canvas2");

    canvasElem.addEventListener("mousedown", function (e) {
        counter++;
        getMousePosition(canvasElem, e);
    });

    canvasElem2.addEventListener("mousedown", function (e) {
        counter2++;
        getMousePosition2(canvasElem2, e);
    });
    //section to draw dashed line

function DrawDottedLine(a1,a2,b1,b2,result){
  //  const canvas = document.querySelector('imgCanvas1')
   // const ctx = canvas.getContext('2d')

     var c = document.getElementById("imgCanvas1");
  var ctx = c.getContext("2d");

    if (ctx.setLineDash !== undefined) {
        ctx.setLineDash([5, 10]);
    }
    if (ctx.mozDash !== undefined) {
        ctx.mozDash = [5, 10];
    }
    ctx.beginPath();
    ctx.lineWidth = "2";
    ctx.strokeStyle = "blue";
    ctx.moveTo(a1, b1);
    ctx.lineTo(a2, b2);
    ctx.stroke();
    ctx.font = "30px Comic Sans MS";
    console.log(result);

    ctx.fillText(result,30,50);
}


//section to draw the circle

   function draw(e) {

    var canvas = document.getElementById("imgCanvas1");
    var context = canvas.getContext("2d");

    var rect = canvas.getBoundingClientRect();
    var posx = e.clientX - rect.left;
    var posy = e.clientY - rect.top;
    if(counter!=3){
    context.fillStyle = "#0000FF"; // to change colour of circle
    context.beginPath();
    context.arc(posx, posy, 10, 0, 2 * Math.PI);  // to change size of circle
    context.fill();
    }else if(counter == 3){
        counter = 0;
    }
    console.log(counter);
}

function addRow(a, b) {

          var table = document.getElementById("myTableData");

          var rowCount = table.rows.length;
          var row = table.insertRow(rowCount);

          row.insertCell(0).innerHTML= '<input type="button" value = "Delete" onClick="Javacsript:deleteRow(this)">';
          row.insertCell(1).innerHTML= a;
          row.insertCell(2).innerHTML= b;

      }
      function deleteRow(obj) {

      var index = obj.parentNode.parentNode.rowIndex;
      var table = document.getElementById("myTableData");
      table.deleteRow(index);
      deleteRow2(index);
      deleteRow3(index);

  }
function addRow2(a, b) {

          var table = document.getElementById("myTableData2");

          var rowCount = table.rows.length;
          var row = table.insertRow(rowCount);

          row.insertCell(0).innerHTML= a;
          row.insertCell(1).innerHTML= b;

      }
      function deleteRow2(obj) {

      var table = document.getElementById("myTableData2");
      table.deleteRow(obj);

  }
function addRow3(result) {

          var table = document.getElementById("myTableData3");

          var rowCount = table.rows.length;
          var row = table.insertRow(rowCount);

          row.insertCell(0).innerHTML= result;

      }
      function deleteRow3(obj) {

      var table = document.getElementById("myTableData3");
      table.deleteRow(obj);

  }
  function load() {

    console.log("Page load finished");

}
function getDistance(x1, y1, x2, y2){
    let y = x2 - x1;
    let x = y2 - y1;

    return Math.sqrt(x * x + y * y);
}

</script>
</body>

</html>